<template>
  <div>
    <div class="cart-dropdown">
      <span class="ml-2 pb-1 Border_social dropdown" title="Share">
        <a
          href="#"
          role="button"
          id="dropdownMenuLink"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="15"
            height="15"
            viewBox="0 0 19 19"
            fill="none"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M12.399 3.27667C12.3989 2.6168 12.6309 1.9779 13.0543 1.47177C13.4777 0.965632 14.0656 0.624489 14.7151 0.508024C15.3646 0.391559 16.0344 0.507187 16.6073 0.83468C17.1801 1.16217 17.6196 1.68067 17.8488 2.29947C18.078 2.91826 18.0823 3.59795 17.861 4.2196C17.6397 4.84126 17.2068 5.3653 16.6382 5.70004C16.0695 6.03479 15.4012 6.15892 14.7503 6.05071C14.0993 5.94251 13.5072 5.60886 13.0774 5.10814L5.51976 8.61809C5.6935 9.1687 5.6935 9.75945 5.51976 10.3101L13.0774 13.82C13.5317 13.2916 14.166 12.9507 14.8573 12.8634C15.5487 12.776 16.2478 12.9484 16.8193 13.3472C17.3907 13.7459 17.7938 14.3426 17.9504 15.0216C18.107 15.7006 18.006 16.4136 17.6668 17.0223C17.3277 17.6311 16.7747 18.0923 16.1149 18.3165C15.4552 18.5407 14.7356 18.5121 14.0958 18.236C13.456 17.96 12.9414 17.4562 12.6518 16.8224C12.3622 16.1886 12.3182 15.4699 12.5284 14.8055L4.97077 11.2955C4.59664 11.7316 4.09795 12.0425 3.54179 12.1866C2.98563 12.3307 2.39868 12.301 1.8599 12.1016C1.32112 11.9021 0.856346 11.5424 0.528112 11.0709C0.199878 10.5993 0.0239258 10.0386 0.0239258 9.46407C0.0239258 8.88955 0.199878 8.3288 0.528112 7.85728C0.856346 7.38575 1.32112 7.02605 1.8599 6.82658C2.39868 6.6271 2.98563 6.59742 3.54179 6.74152C4.09795 6.88562 4.59664 7.19659 4.97077 7.6326L12.5284 4.12266C12.4424 3.84892 12.3987 3.56362 12.399 3.27667Z"
              fill="#697077"
            />
          </svg>
        </a>

        <div
          class="dropdown-menu"
          style="color: black; padding: 0px;  min-width: 0px"
          aria-labelledby="dropdownMenuLink"
        >
          <div class="dropdown-item pointer" @click="openfbLink">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="33"
              height="33"
              viewBox="0 0 33 33"
              fill="none"
            >
              <circle cx="16.605" cy="16.4648" r="16" fill="#5D75CA" />
              <rect x="8.53101" y="8.21631" width="16.1482" height="16.1482" rx="2" fill="white" />
              <path
                d="M16.4249 19.1073C16.3796 19.1073 15.3825 19.1073 14.9293 19.1073C14.6876 19.1073 14.6121 19.0166 14.6121 18.79C14.6121 18.1857 14.6121 17.5663 14.6121 16.9621C14.6121 16.7203 14.7027 16.6448 14.9293 16.6448H16.4249C16.4249 16.5995 16.4249 15.7233 16.4249 15.3154C16.4249 14.7111 16.5307 14.137 16.8328 13.6083C17.1501 13.0644 17.6033 12.7018 18.1774 12.4903C18.555 12.3544 18.9327 12.2939 19.3406 12.2939H20.8211C21.0326 12.2939 21.1233 12.3846 21.1233 12.5961V14.3183C21.1233 14.5298 21.0326 14.6204 20.8211 14.6204C20.4132 14.6204 20.0053 14.6204 19.5974 14.6356C19.1895 14.6356 18.978 14.8319 18.978 15.255C18.9629 15.7082 18.978 16.1463 18.978 16.6146H20.7305C20.9722 16.6146 21.0628 16.7052 21.0628 16.947V18.7749C21.0628 19.0166 20.9873 19.0922 20.7305 19.0922C20.1866 19.0922 19.0234 19.0922 18.978 19.0922V24.0171C18.978 24.2739 18.9025 24.3646 18.6306 24.3646C17.9961 24.3646 17.3767 24.3646 16.7422 24.3646C16.5156 24.3646 16.4249 24.2739 16.4249 24.0473C16.4249 22.4611 16.4249 19.1526 16.4249 19.1073Z"
                fill="#5D75CA"
              />
            </svg>
          </div>
          <!-- <div class="dropdown-divider"></div> -->

          <div class="dropdown-item pointer">
            <a :href="composeMailLink">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="33"
                height="33"
                viewBox="0 0 33 33"
                fill="none"
              >
                <circle cx="16.605" cy="16.4648" r="16" fill="#C90010" />
                <path
                  d="M24.541 8.00643L24.5217 7.98878C24.1518 7.65093 23.6723 7.46484 23.1716 7.46484C22.6103 7.46484 22.0713 7.70247 21.6929 8.11674L14.5373 15.9507C14.4721 16.022 14.4226 16.1063 14.392 16.198L13.5506 18.7204C13.4534 19.012 13.5022 19.3345 13.6812 19.583C13.8617 19.8335 14.1524 19.9831 14.459 19.9831C14.5916 19.9831 14.7213 19.9558 14.8442 19.902L17.2804 18.8363C17.3689 18.7975 17.4484 18.7406 17.5136 18.6692L24.6692 10.8354C25.4138 10.0202 25.3564 8.75127 24.541 8.00643ZM15.1627 18.2544L15.6564 16.7743L15.6981 16.7287L16.6339 17.5834L16.5922 17.629L15.1627 18.2544ZM23.6489 9.90344L17.5658 16.5632L16.63 15.7085L22.7132 9.04869C22.8322 8.91843 22.995 8.84667 23.1717 8.84667C23.3267 8.84667 23.4751 8.90433 23.59 9.00926L23.6093 9.0269C23.8619 9.25762 23.8797 9.65084 23.6489 9.90344Z"
                  fill="white"
                />
                <path
                  d="M23.1526 13.8392C22.771 13.8392 22.4617 14.1486 22.4617 14.5301V20.3958C22.4617 21.3647 21.6734 22.1529 20.7046 22.1529H12.3308C11.3619 22.1529 10.5737 21.3647 10.5737 20.3958V12.0901C10.5737 11.1212 11.362 10.333 12.3308 10.333H18.3918C18.7733 10.333 19.0827 10.0236 19.0827 9.64208C19.0827 9.26052 18.7733 8.95117 18.3918 8.95117H12.3308C10.6 8.95117 9.19189 10.3593 9.19189 12.0901V20.3958C9.19189 22.1266 10.6 23.5347 12.3308 23.5347H20.7045C22.4353 23.5347 23.8434 22.1266 23.8434 20.3958V14.5301C23.8435 14.1486 23.5341 13.8392 23.1526 13.8392Z"
                  fill="white"
                />
              </svg>
            </a>
          </div>
          <!-- <div class="dropdown-divider"></div> -->

          <div class="dropdown-item pointer">
            <div
              class="btn-coupon"
              @click.prevent="Cobycode"
              :data-clipboard-text="`https://VietnamPrintPack.chanchao.com.tw${NowPageUrl}`"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="33"
                height="33"
                viewBox="0 0 33 33"
                fill="none"
              >
                <circle cx="16.605" cy="16.4648" r="16" fill="#3F4347" />
                <path
                  d="M13.1174 15.7514H16.847C17.2145 15.7514 17.5125 15.4534 17.5125 15.0859C17.5125 14.7183 17.2145 14.4204 16.847 14.4204H13.1174C12.7498 14.4204 12.4519 14.7183 12.4519 15.0859C12.4519 15.4534 12.7498 15.7514 13.1174 15.7514Z"
                  fill="white"
                />
                <path
                  d="M13.1174 18.7416H16.847C17.2145 18.7416 17.5125 18.4437 17.5125 18.0761C17.5125 17.7086 17.2145 17.4106 16.847 17.4106H13.1174C12.7498 17.4106 12.4519 17.7086 12.4519 18.0761C12.4519 18.4437 12.7498 18.7416 13.1174 18.7416Z"
                  fill="white"
                />
                <path
                  d="M13.1174 21.7318H16.847C17.2145 21.7318 17.5125 21.4339 17.5125 21.0664C17.5125 20.6988 17.2145 20.4009 16.847 20.4009H13.1174C12.7498 20.4009 12.4519 20.6988 12.4519 21.0664C12.4519 21.4339 12.7498 21.7318 13.1174 21.7318Z"
                  fill="white"
                />
                <path
                  d="M23.4395 16.4373C23.807 16.4373 24.105 16.1394 24.105 15.7719V10.6087C24.105 9.14092 22.9108 7.94678 21.443 7.94678H15.013C13.5453 7.94678 12.3511 9.14092 12.3511 10.6087V11.1689H11.7669C10.2991 11.1689 9.10498 12.363 9.10498 13.8308V22.3212C9.10498 23.789 10.2991 24.9832 11.7669 24.9832H18.1969C19.6647 24.9832 20.8589 23.789 20.8589 22.3212V21.7611H21.443C22.9107 21.7611 24.1048 20.567 24.105 19.0994C24.105 18.7318 23.8071 18.4339 23.4396 18.4338H23.4395C23.072 18.4338 22.774 18.7317 22.774 19.0993C22.7739 19.8331 22.1769 20.4301 21.443 20.4301H20.8588V13.8308C20.8588 12.363 19.6647 11.1689 18.1969 11.1689H13.6821V10.6087C13.6821 9.87482 14.2791 9.27774 15.013 9.27774H21.443C22.1769 9.27774 22.774 9.87482 22.774 10.6087V15.7719C22.774 16.1394 23.072 16.4373 23.4395 16.4373ZM18.1969 12.4998C18.9308 12.4998 19.5279 13.0969 19.5279 13.8308V22.3212C19.5279 23.0551 18.9308 23.6522 18.1969 23.6522H11.7669C11.033 23.6522 10.4359 23.0551 10.4359 22.3212V13.8308C10.4359 13.0969 11.033 12.4998 11.7669 12.4998H18.1969Z"
                  fill="white"
                />
              </svg>
            </div>
          </div>
        </div>
      </span>
    </div>
  </div>
</template>

<script>
import $ from "jquery";
import { mapGetters } from "vuex";

export default {
  data() {
    return {
      deleteItem: ""
    };
  },
  methods: {
    getCart() {
      this.$store.dispatch("getCart");
    },

    deleteCartItem(id) {
      const vm = this;
      const api = `${process.env.VUE_APP_APIPATH}/api/${process.env.VUE_APP_CUSTOMPATH}/cart/${id}`;
      vm.deleteItem = id;

      vm.$http.delete(api).then(response => {
        if (response.data.success) {
          vm.getCart();
          vm.$bus.$emit("message:push", response.data.message, "danger");
          vm.deleteItem = "";
        }
      });
    },

    openList() {
      $(".dropdown-cart-menu").toggle();
      setTimeout(() => {
        $(".dropdown-cart-menu").fadeOut(2000);
      }, 15000);
    },

    closeList() {
      $(".dropdown-cart-menu").hide();
    },

    goCheckout() {
      const vm = this;
      if (vm.cartNum !== 0) {
        vm.$router.push("/order_check");
      }
    }
  },

  computed: {
    ...mapGetters(["cart", "total", "cartNum"])
  },

  created() {
    const vm = this;
    vm.getCart();
  }
};
</script>

<style lang="scss" scoped>
.cart-dropdown {
  position: fixed;
  bottom: 15px;
  left: 100px;
}
.fixPage {
  position: absolute;
  right: 20px;
  bottom: 20px;
  height: 65px;
  width: 65px;
  z-index: 1000;
  cursor: pointer;
}

.dropdown-header {
  margin-bottom: -14px;
}

.badge {
  transform: translate(55px, -75px);
  font-size: 11px;
  background-color: #df6b57;
  color: #fff;
}
.cart-box {
  position: relative;
  bottom: 80px;
  right: 85px;
  box-shadow: 0.6rem 0rem 0.625rem 0.1875rem gray;
  background-color: #fff;
  z-index: 1000;

  @media (max-width: 575.98px) {
    right: 5px;
    bottom: -10px;
  }
}
.fa-window-close {
  margin-left: 120px;
  color: gray;
}

.cart-dropdown-item-image {
  display: inline-block;
  width: 2.5rem;
  height: 2.5rem;
  background-size: cover;
  background-position: center;
}

.cart-icon {
  width: 1.5625rem;
  height: 1.5625rem;
  cursor: pointer;
  color: red;
  border: 0.0625rem solid red;
  padding: 0.8rem;
  transition: all 0.3s ease;

  &:hover {
    color: white;
    border: 0.0625rem solid red;
    background-color: red;
  }
}

.dropdown-item {
  background-color: rgba(21, 21, 21, 0.78039);
}

.dropdown-menu {
  padding: 0px 0px 0px 0px;
}
</style>
